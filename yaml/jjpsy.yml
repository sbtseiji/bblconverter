constants:
  maxnames: 20

names:
  - author
  - editor
  - editora
  - translator
  - translatora
  - origauthor

parenyear: &parenyeardot
  - text::"("
  - - cond::ifdef[year,true]
    - value::year
    - value::pubstate
  - text::"). "


jname: &jname 
    - cond::ifequal[listcount,maxnames]&&ifless[listcount,listtotal]
    - text::"..."
    - - cond::ifgreater[listcount,maxnames]&&ifless[listcount,listtotal]
      - text::""
      - - cond::ifequal[listcount,1]
        - - value::family
          - text::" "
          - value::given
        - - cond::ifless[listcount,maxnames]
          - - text::"・"
            - value::family
            - text::" "
            - value::given
          - - value::family
            - text::" "
            - value::given

enamej: &enamej
    - cond::ifequal[listcount,maxnames]&&ifless[listcount,listtotal]
    - text::"..."
    - - cond::ifgreater[listcount,maxnames]&&ifless[listcount,listtotal]
      - text::""
      - - cond::ifequal[listcount,1]
        - - value::family
          - text::"，"
          - value::given
        - - cond::iflesseq[listcount,maxnames]&&ifequal[listcount,listtotal]
          - - text::"，& "
            - value::family
            - text::"，"
            - value::given
          - - cond::ifless[listcount,maxnames]
            - - text::"，"
              - value::family
              - text::"，"
              - value::given
            - - value::family
              - text::"，"
              - value::given

ename: &ename
    - cond::ifequal[listcount,maxnames]&&ifless[listcount,listtotal]
    - text::"..."
    - - cond::ifgreater[listcount,maxnames]&&ifless[listcount,listtotal]
      - text::""
      - - cond::ifequal[listcount,1]
        - - value::family
          - text::", "
          - value::given
        - - cond::iflesseq[listcount,maxnames]&&ifequal[listcount,listtotal]
          - - text::", & "
            - value::family
            - text::", "
            - value::given
          - - cond::ifless[listcount,maxnames]
            - - text::", "
              - value::family
              - text::", "
              - value::given
            - - value::family
              - text::", "
              - value::given

jauthor: &jauthor
  -
    - cond::ifdef[field::author,true]
    - *jname

jauthore: &jauthore
  -
    - cond::ifdef[field::author,true]
    -
      *enamej

origauthor: &origauthor
  -
    - cond::ifdef[field::origauthor,true]
    -
      *ename

authortype: &authortype
  - 
    - cond::ifdef[field::author,true]
    -
      - cond::ifdef[field::authortype,true]
      -
        - text::"("
        - value::authortype
        - text::") "

jeditor: &jeditor
  -
    - cond::ifdef[field::editor,true]
    -
      *jname

jeditortype: &jeditortype
  - 
    - cond::ifdef[field::editortype,true]
    -
      - cond::ifdef[field::editortype,true]
      -
        - text::"("
        - value::editortype
        - text::")"
      -
        - text::"(編)"

jtranslator: &jtranslator
  -
    - cond::ifdef[field::translator,true]
    -
      *jname

jtranslatora: &jtranslatora
  -
    - cond::ifdef[field::translatora,true]
    -
      *jname


jtranslatortype: &jtranslatortype
  - 
    - cond::ifdef[field::translator,true]
    -
      - cond::ifdef[field::translatortype,true]
      -
        - text::"("
        - value::translatortype
        - text::")"
      -
        - text::"(訳)"

jtranslatoratype: &jtranslatoratype
  - 
    - cond::ifdef[field::translatora,true]
    -
      - cond::ifdef[field::translatoratype,true]
      -
        - text::"("
        - value::translatoratype
        - text::")"
      -
        - text::"(訳)"

jtitle: &jtitle
  - value::title
  -
    - cond::ifdef[field::subtitle,true]
    - 
      - delim::EMDASH
      - delim::EMDASH
      - value::subtitle
      - delim::EMDASH
      - delim::EMDASH
  - punct::""

jtitlesp: &jtitlesp
  - value::title
  -
    - cond::ifdef[field::subtitle,true]
    - 
      - delim::EMDASH
      - delim::EMDASH
      - value::subtitle
      - delim::EMDASH
      - delim::EMDASH
  - punct::" "

volume: &volume
  - 
    - cond::ifdef[field::volume,true]
    -
      - text::", "
      - value::volume::italic
  -
    - cond::ifdef[field::number,true]
    -
      - cond::ifdef[field::volume,true]
      -
        - text::"("
        - value::number
        - text::")"
      -
        - text::", No."
        - value::number

bookvolume: &bookvolume
  -
    - cond::ifdef[field::volume,true]
    -
      - 
        - text::" "
        - value::volume
      -
        - cond::ifdef[field::number,true]
        - value::number
    -
      - cond::ifdef[field::number,true]
      -
        - text::" "
        - value::number


AuthorEditorSpace: 
  - &aespace
    - cond::ifdef[field::author,true]&&ifdef[field::editor,true]
    - text::" "


CommaPagesDot: &CommaPagesDot
  -
    - cond::ifdef[field::pages,true]
    -
      - text::", "
      - value::pages
      - text::"."
  - punct::""

howpublished: &howpublished
  -
    - cond::ifdef[field::howpublished,true]
    - 
      - text::"　"
      - value::howpublished
      - punct::"."

doi: &doi
  - 
    - cond::ifdef[field::doi,true]
    - 
      - text::" "
      - url::["https://doi.org/",value::doi]


jbook: &jbook
    - author: *jauthor
    - authortype: *authortype
    - *aespace
    - editor: *jeditor
    - editortype: *jeditortype
    - year: *parenyeardot
    - title: *jtitle
    -
      - cond::ifdef[field::edition,true]
      - edition:
        - value::edition
    -
      - cond::ifdef[field::related::author,true]
      - text::" "
    - related::author: *jauthor
    - related::authortype: *authortype
    -
      - cond::ifdef[field::related::editor,true]
      - text::" "
    - related::editor: *jeditor
    - related::editortype: *jeditortype
    - related::series:
      - text::" "
      - value::series
    - related::volume: *bookvolume
    - publisher:
      - text::"　"
      - value::publisher


################# 各文献種別の書式 ################# 
driver:
  japanese:
    article:
      - author: *jauthor
      - year: *parenyeardot
      - title: *jtitlesp
      - journaltitle:
        - value::journaltitle
      - volume: *volume
      - pages: *CommaPagesDot
      - howpublished: *howpublished
      - doi: *doi

    book:
      - - cond::ifdef[field::translator,true]&&ifdef[field::related,false]
        - - origauthor: *origauthor
          - origyear:
            - text::"("
            - value::origyear
            - text::"). "
          - origtitle:
            - value::origtitle::italic
            - - cond::ifdef[field::origsubtitle,true]
              - - delim::COLON::italic
                - text::" "
                - value::origsubtitle::italic
            - punct::"."
            - text::" "
          - origpublisher:
            - value::origpublisher
            - delim::LINEBREAK
            - text::"("
      - - cond::ifequal[value::relationtype,translationof]
        - related::author:
          - text::"hoge"
      - - cond::ifdef[field::translator,true]
        - author: *jauthore
        - author: *jauthor
      - - cond::ifdef[field::translator,true]
        - authortype: *authortype
        - authortype: *authortype
      - *aespace
      - - cond::ifdef[field::translator,true]
        - editor: *jeditor
        - editor: *jeditor
      - - cond::ifdef[field::translator,true]
        - editortype: *jeditortype
        - editortype: *jeditortype
      - year: *parenyeardot
      - title: *jtitle
      - - cond::ifdef[field::edition,true]
        - edition:
          - value::edition
      - - cond::ifdef[field::related::author,true]
        - text::" "
      - related::author: *jauthor
      - related::authortype: *authortype
      - - cond::ifdef[field::related::editor,true]
        - text::" "
      - related::editor: *jeditor
      - related::editortype: *jeditortype
      - - cond::ifdef[field::translator,true]
        - text::" "
      - translator: *jtranslator
      - translatortype: *jtranslatortype
      - - cond::ifdef[field::translatora,true]
        - text::" "
      - translatora: *jtranslatora
      - translatoratype: *jtranslatoratype
      - related::series:
        - text::" "
        - value::series
      - related::volume: *bookvolume
      - publisher:
        - text::"　"
        - value::publisher
      - - cond::ifdef[field::translator,true]
        - text::")"


  other:
    article:
    - text::a
# 