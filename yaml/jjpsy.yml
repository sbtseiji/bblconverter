constants:
  maxnames: 20

names:
  - author
  - editor
  - editora
  - translator
  - origauthor

parenyear: &parenyeardot
  - text::"("
  - 
    - cond::ifdef[year,true]
    - value::year
    - value::pubstate
  - text::"). "


family-giveni: &family-giveni 
  - 
    - cond::ifequal[listcount,maxnames]&&ifless[listcount,listtotal]
    - text::"... "
    -
      - cond::ifgreater[listcount,maxnames]&&ifless[listcount,listtotal]
      -
        - text::""
      -
        - cond::ifequal[listcount,1]
        - 
          - value::family
          - text::", "
          - value::giveni
        - cond::ifless[listcount,maxnames]
        -
          - cond::ifequal[listcount,listtotal]
          -
            - text::", & "
            - value::family
            - text::", "
            - value::giveni
          -
            - text::", "
            - value::family
            - text::", "
            - value::giveni                
        -
          - value::family
          - text::", "
          - value::giveni
  # - count::1

jname: &jname 
    - cond::ifequal[listcount,maxnames]&&ifless[listcount,listtotal]
    - text::"..."
    -
      - cond::ifgreater[listcount,maxnames]&&ifless[listcount,listtotal]
      - text::""
      - 
        - cond::ifequal[listcount,1]
        - 
          - value::family
          - text::" "
          - value::given
        -
          - cond::ifless[listcount,maxnames]
          -
            - text::"・"
            - value::family
            - text::" "
            - value::given
          -
            - value::family
            - text::" "
            - value::given

jauthor: &jauthor
  -
    - cond::ifdef[field::author,true]
    -
      *jname

authortype: &authortype
  - 
    - cond::ifdef[field::author,true]
    -
      - cond::ifdef[field::authortype,true]
      -
        - text::"("
        - value::authortype
        - text::") "

jeditor: &jeditor
  -
    - cond::ifdef[field::editor,true]
    -
      *jname

jeditortype: &jeditortype
  - 
    - cond::ifdef[field::editor,true]
    -
      - cond::ifdef[field::editortype,true]
      -
        - text::"("
        - value::editortype
        - text::")"
      -
        - text::"(編)"

jtitle: &jtitle
  - value::title
  -
    - cond::ifdef[field::subtitle,true]
    - 
      - delim::EMDASH
      - delim::EMDASH
      - value::subtitle
      - delim::EMDASH
      - delim::EMDASH
  - punct::" "

volume: &volume
  - 
    - cond::ifdef[field::volume,true]
    -
      - text::", "
      - value::volume::italic
  -
    - cond::ifdef[field::number,true]
    -
      - cond::ifdef[field::volume,true]
      -
        - text::"("
        - value::number
        - text::")"
      -
        - text::", No."
        - value::number

comma-pages-dot: &comma-pages-dot
  -
    - cond::ifdef[field::pages,true]
    -
      - text::", "
      - value::pages
      - text::"."
  - punct::""

howpublished: &howpublished
  -
    - cond::ifdef[field::howpublished,true]
    - 
      - text::"　"
      - value::howpublished
      - punct::"."

doi: &doi
  - 
    - cond::ifdef[field::doi,true]
    - 
      - text::" "
      - url::["https://doi.org/",value::doi]


################# 各文献種別の書式 ################# 
driver:
  japanese:
    article:
      - author: *jauthor
      - year: *parenyeardot
      - title: *jtitle
      - journaltitle:
        - value::journaltitle
      - volume: *volume
      - pages: *comma-pages-dot
      - howpublished: *howpublished
      - doi: *doi

    book: 
      - author: *jauthor
      - authortype: *authortype
      - editor: *jeditor
      - editortype: *jeditortype
      - year: *parenyeardot
      - title: *jtitle
      -
        - cond::ifdef[field::edition,true]
        - edition:
          - value::edition
      - related::author: *jauthor
      - related::authortype: *authortype
      - publisher:
        - value::publisher


  

# 